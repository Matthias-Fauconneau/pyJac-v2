#include "chem_utils.oh"
#define lid(N) ((int) get_local_id(N))
#define gid(N) ((int) get_group_id(N))
#if __OPENCL_C_VERSION__ < 120
#pragma OPENCL EXTENSION cl_khr_fp64: enable
#endif

__constant double const T_mid[31] = { 1000.0, 1000.0, 1000.0, 1000.0, 1000.0, 1000.0, 1000.0, 1000.0, 1000.0, 1000.0, 1387.0, 1000.0, 1401.0, 1383.0, 1000.0, 1000.0, 1000.0, 1000.0, 1000.0, 1000.0, 1000.0, 1410.0, 1000.0, 1000.0, 1000.0, 1386.0, 1000.0, 1000.0, 1000.0, 1000.0, 1000.0 };
__constant double const a_hi[7 * 31] = { 3.3372792, 2.50000001, 2.56942078, 3.28253784, 3.09288767, 3.03399249, 4.0172109, 4.16500285, 2.5, 2.9781206, 5.8878439, 8.88872432, 17.2230301, 17.0194059, 3.8022392, 5.209703, 2.71518561, 3.85746029, 0.074851495, 2.03611116, 1.0718815, 8.32598158, 4.6138316, 5.4041108, 6.53928338, 10.4146322, 16.3582907, 3.16780652, 10.9540673, 8.6897813, 2.92664, -4.94024731e-05, -2.30842973e-11, -8.59741137e-05, 0.00148308754, 0.000548429716, 0.00217691804, 0.00223982013, 0.00490831694, 0.0, 0.005797852, 0.0103076793, 0.0135833179, 0.0222593435, 0.0223541546, 0.0031464228, 0.0029692911, 0.00206252743, 0.00441437026, 0.0133909467, 0.0146454151, 0.0216852677, 0.00803387281, 0.0064496364, 0.011723059, 0.00780238629, 0.0112680116, 0.0211974105, 0.00475221902, 0.0182072569, 0.00669732229, 0.0014879768, 4.99456778e-07, 1.61561948e-14, 4.19484589e-08, -7.57966669e-07, 1.26505228e-07, -1.64072518e-07, -6.3365815e-07, -1.90139225e-06, 0.0, -1.97558e-06, -3.46844396e-06, -4.91116949e-06, -7.57391529e-06, -7.59760895e-06, -1.0632185e-06, -2.8555891e-07, -9.98825771e-07, -2.21481404e-06, -5.73285809e-06, -6.71077915e-06, -1.00256067e-05, -2.63928405e-06, -2.2908251e-06, -4.2263137e-06, -2.76413612e-06, -5.17494839e-06, -7.65817215e-06, -1.83787077e-06, -6.63331157e-06, -2.34774865e-06, -5.68476e-07, -1.79566394e-10, -4.73515235e-18, -1.00177799e-11, 2.09470555e-10, -8.79461556e-11, -9.7041987e-11, 1.1424637e-10, 3.71185986e-10, 0.0, 3.072979e-10, 5.32499257e-10, 7.92343362e-10, 1.17156666e-09, 1.17496754e-09, 1.6619757e-10, -1.63555e-10, 2.30053008e-10, 5.23490188e-10, 1.22292535e-09, 1.47222923e-09, 2.21412001e-09, 3.98410726e-10, 3.6716047e-10, 6.8372451e-10, 4.42098906e-10, 1.00333285e-09, 1.24134505e-09, 3.04190252e-10, 1.0812569e-09, 3.72759231e-10, 1.0097038e-10, 2.00255376e-14, 4.98197357e-22, 1.22833691e-15, -2.16717794e-14, 1.17412376e-14, 1.68200992e-14, -1.07908535e-14, -2.87908305e-14, 0.0, -1.7917416e-14, -3.06512651e-14, -4.73525704e-14, -6.77917454e-14, -6.79975164e-14, -9.799757e-15, 3.0432589e-14, -2.03647716e-14, -4.72084164e-14, -1.0181523e-13, -1.25706061e-13, -1.9000289e-13, -2.26551155e-14, -2.1873675e-14, -4.0984863e-14, -2.6295429e-14, -6.68165911e-14, -7.4532796e-14, -1.7723277e-14, -6.51736617e-14, -2.20554548e-14, -6.753351e-15, -950.158922, 25473.6599, 29217.5791, -1088.45772, 3858.657, -30004.2971, 111.856713, -17861.7877, -745.375, 16509.513, 11506.5499, -7441.07388, -33118.6152, -36914.3302, 14407.292, 27677.109, -14151.8724, -48759.166, -9468.34459, 4939.88614, -11426.3932, -18322.1436, -47514.85, -22593.122, -1188.58659, -14095.5672, 31037.534, 67121.065, 35109.8413, 51994.2624, -922.7977, -3.20502331, -0.446682914, 4.78433864, 5.45323129, 4.4766961, 4.9667701, 3.78510215, 2.91615662, 4.366, 4.7224799, -8.49651771, -19.0789836, -65.0020716, -63.5871575, 1.5754601, -4.444478, 7.81868772, 2.27163806, 18.437318, 10.3053693, 15.1156107, -20.2080305, 0.84788383, -3.4807917, -8.72091393, -22.78944, -62.2520227, 6.63589475, -36.4320659, -22.0010465, 5.980528 };
__constant double const a_lo[7 * 31] = { 2.34433112, 2.5, 3.1682671, 3.78245636, 3.99201543, 4.19864056, 4.30179801, 4.27611269, 2.5, 3.6571797, 1.32730217, 4.50099327, -1.94022087, 0.861033163, 2.2589886, 2.851661, 3.57953347, 2.35677352, 5.14987613, 3.95920148, 4.29142492, -0.12797226, 3.8983616, 4.7294595, 2.795026, 2.22681686, -2.74707918, 2.88965733, 0.491024498, -0.584768273, 3.298677, 0.00798052075, 7.05332819e-13, -0.00327931884, -0.00299673416, -0.00240131752, -0.0020364341, -0.00474912051, -0.000542822417, 0.0, 0.0021265979, 0.0176656753, 0.00687965342, 0.0714827733, 0.0573441683, 0.01005117, 0.0056952331, -0.00061035368, 0.00898459677, -0.0136709788, -0.00757052247, -0.0055015427, 0.0338506073, -0.0035587795, -0.0031932858, 0.0101099472, 0.035678138, 0.0778284438, 0.0134099611, 0.0172669813, 0.0533506727, 0.0014082404, -1.9478151e-05, -1.99591964e-15, 6.64306396e-06, 9.84730201e-06, 4.61793841e-06, 6.52040211e-06, 2.11582891e-05, 1.67335701e-05, 0.0, 5.4583883e-06, -6.14926558e-06, 4.74143971e-05, -5.72564918e-05, -3.59178644e-05, -1.3351763e-05, 1.07114e-06, 1.01681433e-06, -7.12356269e-06, 4.91800599e-05, 5.70990292e-05, 5.99438288e-05, -3.30644935e-05, 3.5520538e-05, 4.7534921e-05, 1.61750645e-05, -3.26401909e-05, -6.69709932e-05, -2.84769501e-05, 7.02556406e-05, -9.50805952e-05, -3.963222e-06, 2.01572094e-08, 2.30081632e-18, -6.12806624e-09, -9.68129509e-09, -3.88113333e-09, -5.48797062e-09, -2.42763894e-08, -2.15770813e-08, 0.0, -6.6181003e-09, -3.01143466e-10, -6.92287127e-08, 2.43814756e-08, 1.13951893e-08, 1.0092349e-08, -1.622612e-09, 9.07005884e-10, 2.45919022e-09, -4.84743026e-08, -6.91588753e-08, -7.08466285e-08, 1.64858739e-08, -4.3849959e-08, -5.7458611e-08, -3.10303145e-08, 1.47651988e-08, 2.37972496e-08, 2.94791045e-08, -1.13389805e-07, 8.37959674e-08, 5.641515e-09, -7.37611761e-12, -9.27732332e-22, 2.11265971e-12, 3.24372837e-12, 1.3641147e-12, 1.77197817e-12, 9.29225124e-12, 8.62454363e-12, 0.0, 2.4657074e-12, 4.38617775e-13, 2.87395324e-11, -4.24851023e-12, -1.46205706e-12, -3.0089028e-12, -2.3511081e-13, -9.04424499e-13, -1.43699548e-13, 1.66693956e-11, 2.69884373e-11, 2.68685771e-11, -3.19935455e-12, 1.7107769e-11, 2.1931112e-11, 1.39436139e-11, -2.6479438e-12, -8.43279765e-13, -1.09331511e-11, 4.89202543e-11, -2.80912179e-11, -2.444854e-12, -917.935173, 25473.6599, 29122.2592, -1063.94356, 3615.08056, -30293.7267, 294.80804, -17702.5821, -745.375, 16422.716, 13428.4028, -5395.47911, -26879.8428, -30995.1354, 14712.633, 28637.82, -14344.086, -48371.9697, -10246.6476, 5089.77593, -11522.2055, -15991.4544, -46770.609, -21572.878, 162.944975, -11873.5095, 36113.1008, 66839.3932, 39234.051, 53611.116, -1020.8999, 0.683010238, -0.446682853, 2.05193346, 3.65767573, -0.103925458, -0.849032208, 3.71666245, 3.43505074, 4.366, 1.6735354, 17.1789216, 7.91490068, 36.3828341, 24.2264151, 8.9164419, 8.9927511, 3.50840928, 9.90105222, -4.64130376, 4.09733096, 2.66682316, 23.0438601, 7.3495397, 4.1030159, 12.3646657, 19.1581197, 35.4221257, 6.22296438, 24.2505364, 20.9878997, 3.950372 };

__kernel void __attribute__ ((reqd_work_group_size(1, 1, 1))) eval_cp(int const n, __global double const *restrict T_arr, __global double *restrict cp)
{
  double T;
  for (int i = 0; i <= -1 + n; ++i)
  {
    T = T_arr[i];
    for (int k = 0; k <= 30; ++k)
    {
      if (!(T < T_mid[k]))
        cp[31 * i + k] = 8314.4621 * (T * (T * (T * (T * a_hi[124 + k] + a_hi[93 + k]) + a_hi[62 + k]) + a_hi[31 + k]) + a_hi[k]);
      if (T < T_mid[k])
        cp[31 * i + k] = 8314.4621 * (T * (T * (T * (T * a_lo[124 + k] + a_lo[93 + k]) + a_lo[62 + k]) + a_lo[31 + k]) + a_lo[k]);
    }
  }
}
__kernel void __attribute__ ((reqd_work_group_size(1, 1, 1))) eval_h(int const n, __global double const *restrict T_arr, __global double *restrict h)
{
  double T;
  for (int i = 0; i <= -1 + n; ++i)
  {
    T = T_arr[i];
    for (int k = 0; k <= 30; ++k)
    {
      if (!(T < T_mid[k]))
        h[31 * i + k] = 8314.4621 * (T * (T * (T * (T * (T * a_hi[124 + k] / 5.0 + a_hi[93 + k] / 4.0) + a_hi[62 + k] / 3.0) + a_hi[31 + k] / 2.0) + a_hi[k]) + a_hi[155 + k]);
      if (T < T_mid[k])
        h[31 * i + k] = 8314.4621 * (T * (T * (T * (T * (T * a_lo[124 + k] / 5.0 + a_lo[93 + k] / 4.0) + a_lo[62 + k] / 3.0) + a_lo[31 + k] / 2.0) + a_lo[k]) + a_lo[155 + k]);
    }
  }
}
__kernel void __attribute__ ((reqd_work_group_size(1, 1, 1))) eval_cv(int const n, __global double const *restrict T_arr, __global double *restrict cv)
{
  double T;
  for (int i = 0; i <= -1 + n; ++i)
  {
    T = T_arr[i];
    for (int k = 0; k <= 30; ++k)
    {
      if (!(T < T_mid[k]))
        cv[31 * i + k] = 8314.4621 * (T * (T * (T * (T * a_hi[124 + k] + a_hi[93 + k]) + a_hi[62 + k]) + a_hi[31 + k]) + a_hi[k] + -1.0);
      if (T < T_mid[k])
        cv[31 * i + k] = 8314.4621 * (T * (T * (T * (T * a_lo[124 + k] + a_lo[93 + k]) + a_lo[62 + k]) + a_lo[31 + k]) + a_lo[k] + -1.0);
    }
  }
}
__kernel void __attribute__ ((reqd_work_group_size(1, 1, 1))) eval_u(int const n, __global double const *restrict T_arr, __global double *restrict u)
{
  double T;
  for (int i = 0; i <= -1 + n; ++i)
  {
    T = T_arr[i];
    for (int k = 0; k <= 30; ++k)
    {
      if (!(T < T_mid[k]))
        u[31 * i + k] = 8314.4621 * (T * (T * (T * (T * (T * a_hi[124 + k] / 5.0 + a_hi[93 + k] / 4.0) + a_hi[62 + k] / 3.0) + a_hi[31 + k] / 2.0) + a_hi[k]) + -1.0 * T + a_hi[155 + k]);
      if (T < T_mid[k])
        u[31 * i + k] = 8314.4621 * (T * (T * (T * (T * (T * a_lo[124 + k] / 5.0 + a_lo[93 + k] / 4.0) + a_lo[62 + k] / 3.0) + a_lo[31 + k] / 2.0) + a_lo[k]) + -1.0 * T + a_lo[155 + k]);
    }
  }
}
#endif